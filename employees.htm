<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>View Employees - EmployeeSpace</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style> body { font-family: 'Inter', sans-serif; } </style>
</head>
<body class="bg-gradient-to-br from-rose-100 via-white to-rose-50 min-h-screen">

  <!-- Navbar -->
  <header class="bg-gradient-to-r from-fuchsia-700 to-rose-600 text-white shadow-md">
    <div class="max-w-7xl mx-auto flex justify-between items-center p-4">
      <h1 class="text-2xl font-extrabold">EmployeeSpace</h1>
      <nav class="space-x-6 text-sm font-medium">
        <a href="dashboard.htm" class="hover:underline">Dashboard</a>
        <a href="add-employee.htm" class="hover:underline">Add Employee</a>
        <a href="logout.htm" class="hover:underline text-red-300">Logout</a>
      </nav>
    </div>
  </header>

  <!-- Main Section -->
  <section class="max-w-6xl mx-auto py-12 px-4">
    <div class="text-center mb-10">
      <h2 class="text-4xl font-bold text-rose-700 mb-2">All Employees</h2>
      <p class="text-gray-600">Click on an employee to view their profile and details.</p>
    </div>

    <div class="overflow-x-auto shadow rounded-lg bg-white">
      <table class="min-w-full text-sm text-gray-800 divide-y divide-gray-200">
        <thead class="bg-rose-100 text-rose-800">
          <tr>
            <th class="px-4 py-3 text-left">Employee ID</th>
            <th class="px-4 py-3 text-left">Name</th>
            <th class="px-4 py-3 text-left">Email</th>
            <th class="px-4 py-3 text-left">Phone</th>
            <th class="px-4 py-3 text-left">Skills</th>
          </tr>
        </thead>
        <tbody id="employeeTable" class="divide-y divide-gray-100"></tbody>
      </table>
    </div>
  </section>

  <!-- Firebase & Logic -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCsAIu6k-FEGTYMxURGAZJhi9XqSiHmb2E",
      authDomain: "employeespace-12537.firebaseapp.com",
      projectId: "employeespace-12537"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);

    onAuthStateChanged(auth, (user) => {
      if (!user) {
        window.location.href = "login.htm";
      } else {
        loadEmployees();
      }
    });

    async function loadEmployees() {
      const table = document.getElementById("employeeTable");
      table.innerHTML = "";
      const snapshot = await getDocs(collection(db, "employees"));

      const employees = [];
      snapshot.forEach(doc => {
        employees.push({ ...doc.data(), docId: doc.id });
      });

      // Sort by createdAt descending
      employees.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));

      employees.forEach(emp => {
        const row = `
          <tr class="hover:bg-rose-50 cursor-pointer transition" onclick="window.location.href='employee-profile.htm?docId=${emp.docId}'">
            <td class="px-4 py-3">${emp.employeeId || '-'}</td>
            <td class="px-4 py-3">${emp.name}</td>
            <td class="px-4 py-3">${emp.email}</td>
            <td class="px-4 py-3">${emp.phone}</td>
            <td class="px-4 py-3">${emp.skills || '-'}</td>
          </tr>
        `;
        table.innerHTML += row;
      });
    }
  </script>

  <!-- Footer -->
  <footer class="bg-fuchsia-900 text-white text-center py-4 text-sm mt-12">
    <p>Â© 2025 EmployeeSpace. All rights reserved.</p>
  </footer>
</body>
</html>
